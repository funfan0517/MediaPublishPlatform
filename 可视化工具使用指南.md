# 可视化工具使用指南

本文档介绍了系统中提供的两个可视化工具，用于帮助您查看数据库内容和测试系统API接口。

## 目录
1. [数据库可视化工具](#数据库可视化工具)
2. [API接口测试工具](#api接口测试工具)
3. [使用示例](#使用示例)
4. [常见问题](#常见问题)

## 数据库可视化工具

`db_viewer.py` 是一个简易的数据库可视化查询工具，用于查看SQLite数据库中的表结构和数据内容。

### 功能特点
- 自动连接项目中的SQLite数据库
- 显示所有表的结构信息（字段名、数据类型）
- 展示每个表的数据内容（前5行预览）
- 支持将数据导出为JSON文件，方便进一步分析
- 友好的命令行界面

### 使用方法

1. 确保数据库文件存在于 `db/database.db` 路径
2. 在项目根目录执行以下命令：

```bash
python db_viewer.py
```

3. 程序会自动连接数据库并显示所有表的信息
4. 您可以选择将数据导出为JSON文件，导出的文件将保存在 `db_exports` 目录中

## API接口测试工具

`api_tester.py` 是一个简易的API接口测试工具，用于可视化调用和测试系统提供的所有API接口。

### 功能特点
- 支持系统中所有API接口的测试（账号管理、素材管理、用户管理等）
- 详细显示API请求信息和响应结果
- 格式化显示JSON响应内容，方便查看
- 支持将API响应导出为文件，便于记录和比较
- 支持自定义请求参数

### 使用方法

#### 查看所有可用API

在项目根目录执行以下命令，查看系统中所有可用的API接口：

```bash
python api_tester.py
```

#### 执行指定API

执行不需要参数的API：

```bash
python api_tester.py get_accounts
```

执行需要参数的API（使用JSON格式的参数）：

```bash
python api_tester.py get_user_info '{"id": "1"}'
```

```bash
python api_tester.py add_account '{"username": "testuser", "platform": "douyin", "cookie": "test_cookie"}'
```

#### 导出API响应

执行API后，程序会询问是否将响应导出为文件。如果选择 "y"，响应内容将被导出到 `api_responses` 目录下的JSON文件中。

## 使用示例

### 示例1：查看数据库中的账号信息

1. 运行数据库可视化工具：
   ```bash
   python db_viewer.py
   ```

2. 程序会显示数据库中所有表的信息，包括 `user_info` 表（存储账号信息）

3. 您可以选择将数据导出为JSON文件进行进一步分析

### 示例2：测试获取账号列表API

1. 确保后端服务正在运行（`python sau_backend.py`）

2. 运行API测试工具执行 `get_accounts` 接口：
   ```bash
   python api_tester.py get_accounts
   ```

3. 查看API响应结果，了解系统中当前的账号情况

4. 如果需要，将响应导出为文件保存

### 示例3：添加新账号

1. 确保后端服务正在运行

2. 使用API测试工具执行 `add_account` 接口：
   ```bash
   python api_tester.py add_account '{"username": "my_tiktok_account", "platform": "douyin", "cookie": "test_cookie_data"}'
   ```

3. 查看API响应，确认是否添加成功

4. 可以再次使用 `get_accounts` 接口或数据库可视化工具验证账号是否已添加

## 常见问题

### 数据库可视化工具问题

1. **问题**："数据库文件不存在!"
   **解决方法**：确保数据库文件存在于 `db/database.db` 路径，或先运行 `createTable.py` 创建数据库

2. **问题**："数据库操作错误"
   **解决方法**：检查数据库文件权限，确保程序有读写权限

### API接口测试工具问题

1. **问题**："无法连接到API服务器!"
   **解决方法**：确保后端服务正在运行（`python sau_backend.py`），并且地址为 `http://localhost:5409`

2. **问题**："参数格式不正确"
   **解决方法**：确保参数使用正确的JSON格式，例如：`'{"id": "1"}'`（注意引号的使用）

3. **问题**：API执行失败
   **解决方法**：检查API名称是否正确，参数是否符合要求，以及后端服务是否正常运行

## 注意事项

1. 这两个工具都是基于命令行的简易工具，提供基本的可视化和测试功能

2. 数据库可视化工具只显示前5行数据预览，完整数据可以通过导出JSON文件查看

3. API测试工具的响应内容如果过长，只会显示前1000个字符，完整内容可以通过导出文件查看

4. 确保在使用API测试工具前，后端服务正在运行

5. 这些工具是辅助开发和调试的工具，请根据实际需求使用